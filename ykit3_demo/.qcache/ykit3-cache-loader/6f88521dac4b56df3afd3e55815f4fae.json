{"remainingRequest":"/usr/local/lib/node_modules/@qnpm/ykit3-cli/node_modules/babel-loader/lib/index.js??ref--4-2!/usr/local/lib/node_modules/@qnpm/ykit3-cli/node_modules/@qnpm/ykit3-config-resolver/lib/addHotCodeLoader.js!/Users/qitmac001126/Documents/my/ykit3_demo/node_modules/core-js/modules/_typed-array.js","dependencies":[{"path":"/Users/qitmac001126/Documents/my/ykit3_demo/node_modules/core-js/modules/_typed-array.js","hash":"e138e79757688246e2517b74c1851d40"},{"path":"/usr/local/lib/node_modules/@qnpm/ykit3-cli/node_modules/cache-loader-hash/dist/cjs.js","hash":"d62e2d390167bf8193569f1644327c55"},{"path":"/usr/local/lib/node_modules/@qnpm/ykit3-cli/node_modules/babel-loader/lib/index.js","hash":"19adf3159c902f1ed7907f3931384270"},{"path":"/usr/local/lib/node_modules/@qnpm/ykit3-cli/node_modules/@qnpm/ykit3-config-resolver/lib/addHotCodeLoader.js","hash":"c8cef10933c4d5175b7cf2b36412e500"}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgppZiAocmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSkgewogIHZhciBMSUJSQVJZID0gcmVxdWlyZSgnLi9fbGlicmFyeScpOwoKICB2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7CgogIHZhciBmYWlscyA9IHJlcXVpcmUoJy4vX2ZhaWxzJyk7CgogIHZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7CgogIHZhciAkdHlwZWQgPSByZXF1aXJlKCcuL190eXBlZCcpOwoKICB2YXIgJGJ1ZmZlciA9IHJlcXVpcmUoJy4vX3R5cGVkLWJ1ZmZlcicpOwoKICB2YXIgY3R4ID0gcmVxdWlyZSgnLi9fY3R4Jyk7CgogIHZhciBhbkluc3RhbmNlID0gcmVxdWlyZSgnLi9fYW4taW5zdGFuY2UnKTsKCiAgdmFyIHByb3BlcnR5RGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTsKCiAgdmFyIGhpZGUgPSByZXF1aXJlKCcuL19oaWRlJyk7CgogIHZhciByZWRlZmluZUFsbCA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lLWFsbCcpOwoKICB2YXIgdG9JbnRlZ2VyID0gcmVxdWlyZSgnLi9fdG8taW50ZWdlcicpOwoKICB2YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTsKCiAgdmFyIHRvSW5kZXggPSByZXF1aXJlKCcuL190by1pbmRleCcpOwoKICB2YXIgdG9BYnNvbHV0ZUluZGV4ID0gcmVxdWlyZSgnLi9fdG8tYWJzb2x1dGUtaW5kZXgnKTsKCiAgdmFyIHRvUHJpbWl0aXZlID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJyk7CgogIHZhciBoYXMgPSByZXF1aXJlKCcuL19oYXMnKTsKCiAgdmFyIGNsYXNzb2YgPSByZXF1aXJlKCcuL19jbGFzc29mJyk7CgogIHZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpOwoKICB2YXIgdG9PYmplY3QgPSByZXF1aXJlKCcuL190by1vYmplY3QnKTsKCiAgdmFyIGlzQXJyYXlJdGVyID0gcmVxdWlyZSgnLi9faXMtYXJyYXktaXRlcicpOwoKICB2YXIgY3JlYXRlID0gcmVxdWlyZSgnLi9fb2JqZWN0LWNyZWF0ZScpOwoKICB2YXIgZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJyk7CgogIHZhciBnT1BOID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4nKS5mOwoKICB2YXIgZ2V0SXRlckZuID0gcmVxdWlyZSgnLi9jb3JlLmdldC1pdGVyYXRvci1tZXRob2QnKTsKCiAgdmFyIHVpZCA9IHJlcXVpcmUoJy4vX3VpZCcpOwoKICB2YXIgd2tzID0gcmVxdWlyZSgnLi9fd2tzJyk7CgogIHZhciBjcmVhdGVBcnJheU1ldGhvZCA9IHJlcXVpcmUoJy4vX2FycmF5LW1ldGhvZHMnKTsKCiAgdmFyIGNyZWF0ZUFycmF5SW5jbHVkZXMgPSByZXF1aXJlKCcuL19hcnJheS1pbmNsdWRlcycpOwoKICB2YXIgc3BlY2llc0NvbnN0cnVjdG9yID0gcmVxdWlyZSgnLi9fc3BlY2llcy1jb25zdHJ1Y3RvcicpOwoKICB2YXIgQXJyYXlJdGVyYXRvcnMgPSByZXF1aXJlKCcuL2VzNi5hcnJheS5pdGVyYXRvcicpOwoKICB2YXIgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJyk7CgogIHZhciAkaXRlckRldGVjdCA9IHJlcXVpcmUoJy4vX2l0ZXItZGV0ZWN0Jyk7CgogIHZhciBzZXRTcGVjaWVzID0gcmVxdWlyZSgnLi9fc2V0LXNwZWNpZXMnKTsKCiAgdmFyIGFycmF5RmlsbCA9IHJlcXVpcmUoJy4vX2FycmF5LWZpbGwnKTsKCiAgdmFyIGFycmF5Q29weVdpdGhpbiA9IHJlcXVpcmUoJy4vX2FycmF5LWNvcHktd2l0aGluJyk7CgogIHZhciAkRFAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKTsKCiAgdmFyICRHT1BEID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcGQnKTsKCiAgdmFyIGRQID0gJERQLmY7CiAgdmFyIGdPUEQgPSAkR09QRC5mOwogIHZhciBSYW5nZUVycm9yID0gZ2xvYmFsLlJhbmdlRXJyb3I7CiAgdmFyIFR5cGVFcnJvciA9IGdsb2JhbC5UeXBlRXJyb3I7CiAgdmFyIFVpbnQ4QXJyYXkgPSBnbG9iYWwuVWludDhBcnJheTsKICB2YXIgQVJSQVlfQlVGRkVSID0gJ0FycmF5QnVmZmVyJzsKICB2YXIgU0hBUkVEX0JVRkZFUiA9ICdTaGFyZWQnICsgQVJSQVlfQlVGRkVSOwogIHZhciBCWVRFU19QRVJfRUxFTUVOVCA9ICdCWVRFU19QRVJfRUxFTUVOVCc7CiAgdmFyIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnOwogIHZhciBBcnJheVByb3RvID0gQXJyYXlbUFJPVE9UWVBFXTsKICB2YXIgJEFycmF5QnVmZmVyID0gJGJ1ZmZlci5BcnJheUJ1ZmZlcjsKICB2YXIgJERhdGFWaWV3ID0gJGJ1ZmZlci5EYXRhVmlldzsKICB2YXIgYXJyYXlGb3JFYWNoID0gY3JlYXRlQXJyYXlNZXRob2QoMCk7CiAgdmFyIGFycmF5RmlsdGVyID0gY3JlYXRlQXJyYXlNZXRob2QoMik7CiAgdmFyIGFycmF5U29tZSA9IGNyZWF0ZUFycmF5TWV0aG9kKDMpOwogIHZhciBhcnJheUV2ZXJ5ID0gY3JlYXRlQXJyYXlNZXRob2QoNCk7CiAgdmFyIGFycmF5RmluZCA9IGNyZWF0ZUFycmF5TWV0aG9kKDUpOwogIHZhciBhcnJheUZpbmRJbmRleCA9IGNyZWF0ZUFycmF5TWV0aG9kKDYpOwogIHZhciBhcnJheUluY2x1ZGVzID0gY3JlYXRlQXJyYXlJbmNsdWRlcyh0cnVlKTsKICB2YXIgYXJyYXlJbmRleE9mID0gY3JlYXRlQXJyYXlJbmNsdWRlcyhmYWxzZSk7CiAgdmFyIGFycmF5VmFsdWVzID0gQXJyYXlJdGVyYXRvcnMudmFsdWVzOwogIHZhciBhcnJheUtleXMgPSBBcnJheUl0ZXJhdG9ycy5rZXlzOwogIHZhciBhcnJheUVudHJpZXMgPSBBcnJheUl0ZXJhdG9ycy5lbnRyaWVzOwogIHZhciBhcnJheUxhc3RJbmRleE9mID0gQXJyYXlQcm90by5sYXN0SW5kZXhPZjsKICB2YXIgYXJyYXlSZWR1Y2UgPSBBcnJheVByb3RvLnJlZHVjZTsKICB2YXIgYXJyYXlSZWR1Y2VSaWdodCA9IEFycmF5UHJvdG8ucmVkdWNlUmlnaHQ7CiAgdmFyIGFycmF5Sm9pbiA9IEFycmF5UHJvdG8uam9pbjsKICB2YXIgYXJyYXlTb3J0ID0gQXJyYXlQcm90by5zb3J0OwogIHZhciBhcnJheVNsaWNlID0gQXJyYXlQcm90by5zbGljZTsKICB2YXIgYXJyYXlUb1N0cmluZyA9IEFycmF5UHJvdG8udG9TdHJpbmc7CiAgdmFyIGFycmF5VG9Mb2NhbGVTdHJpbmcgPSBBcnJheVByb3RvLnRvTG9jYWxlU3RyaW5nOwogIHZhciBJVEVSQVRPUiA9IHdrcygnaXRlcmF0b3InKTsKICB2YXIgVEFHID0gd2tzKCd0b1N0cmluZ1RhZycpOwogIHZhciBUWVBFRF9DT05TVFJVQ1RPUiA9IHVpZCgndHlwZWRfY29uc3RydWN0b3InKTsKICB2YXIgREVGX0NPTlNUUlVDVE9SID0gdWlkKCdkZWZfY29uc3RydWN0b3InKTsKICB2YXIgQUxMX0NPTlNUUlVDVE9SUyA9ICR0eXBlZC5DT05TVFI7CiAgdmFyIFRZUEVEX0FSUkFZID0gJHR5cGVkLlRZUEVEOwogIHZhciBWSUVXID0gJHR5cGVkLlZJRVc7CiAgdmFyIFdST05HX0xFTkdUSCA9ICdXcm9uZyBsZW5ndGghJzsKICB2YXIgJG1hcCA9IGNyZWF0ZUFycmF5TWV0aG9kKDEsIGZ1bmN0aW9uIChPLCBsZW5ndGgpIHsKICAgIHJldHVybiBhbGxvY2F0ZShzcGVjaWVzQ29uc3RydWN0b3IoTywgT1tERUZfQ09OU1RSVUNUT1JdKSwgbGVuZ3RoKTsKICB9KTsKICB2YXIgTElUVExFX0VORElBTiA9IGZhaWxzKGZ1bmN0aW9uICgpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KG5ldyBVaW50MTZBcnJheShbMV0pLmJ1ZmZlcilbMF0gPT09IDE7CiAgfSk7CiAgdmFyIEZPUkNFRF9TRVQgPSAhIVVpbnQ4QXJyYXkgJiYgISFVaW50OEFycmF5W1BST1RPVFlQRV0uc2V0ICYmIGZhaWxzKGZ1bmN0aW9uICgpIHsKICAgIG5ldyBVaW50OEFycmF5KDEpLnNldCh7fSk7CiAgfSk7CgogIHZhciB0b09mZnNldCA9IGZ1bmN0aW9uIHRvT2Zmc2V0KGl0LCBCWVRFUykgewogICAgdmFyIG9mZnNldCA9IHRvSW50ZWdlcihpdCk7CiAgICBpZiAob2Zmc2V0IDwgMCB8fCBvZmZzZXQgJSBCWVRFUykgdGhyb3cgUmFuZ2VFcnJvcignV3Jvbmcgb2Zmc2V0IScpOwogICAgcmV0dXJuIG9mZnNldDsKICB9OwoKICB2YXIgdmFsaWRhdGUgPSBmdW5jdGlvbiB2YWxpZGF0ZShpdCkgewogICAgaWYgKGlzT2JqZWN0KGl0KSAmJiBUWVBFRF9BUlJBWSBpbiBpdCkgcmV0dXJuIGl0OwogICAgdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSB0eXBlZCBhcnJheSEnKTsKICB9OwoKICB2YXIgYWxsb2NhdGUgPSBmdW5jdGlvbiBhbGxvY2F0ZShDLCBsZW5ndGgpIHsKICAgIGlmICghKGlzT2JqZWN0KEMpICYmIFRZUEVEX0NPTlNUUlVDVE9SIGluIEMpKSB7CiAgICAgIHRocm93IFR5cGVFcnJvcignSXQgaXMgbm90IGEgdHlwZWQgYXJyYXkgY29uc3RydWN0b3IhJyk7CiAgICB9CgogICAgcmV0dXJuIG5ldyBDKGxlbmd0aCk7CiAgfTsKCiAgdmFyIHNwZWNpZXNGcm9tTGlzdCA9IGZ1bmN0aW9uIHNwZWNpZXNGcm9tTGlzdChPLCBsaXN0KSB7CiAgICByZXR1cm4gZnJvbUxpc3Qoc3BlY2llc0NvbnN0cnVjdG9yKE8sIE9bREVGX0NPTlNUUlVDVE9SXSksIGxpc3QpOwogIH07CgogIHZhciBmcm9tTGlzdCA9IGZ1bmN0aW9uIGZyb21MaXN0KEMsIGxpc3QpIHsKICAgIHZhciBpbmRleCA9IDA7CiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGg7CiAgICB2YXIgcmVzdWx0ID0gYWxsb2NhdGUoQywgbGVuZ3RoKTsKCiAgICB3aGlsZSAobGVuZ3RoID4gaW5kZXgpIHsKICAgICAgcmVzdWx0W2luZGV4XSA9IGxpc3RbaW5kZXgrK107CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9OwoKICB2YXIgYWRkR2V0dGVyID0gZnVuY3Rpb24gYWRkR2V0dGVyKGl0LCBrZXksIGludGVybmFsKSB7CiAgICBkUChpdCwga2V5LCB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLl9kW2ludGVybmFsXTsKICAgICAgfQogICAgfSk7CiAgfTsKCiAgdmFyICRmcm9tID0gZnVuY3Rpb24gZnJvbShzb3VyY2UKICAvKiAsIG1hcGZuLCB0aGlzQXJnICovCiAgKSB7CiAgICB2YXIgTyA9IHRvT2JqZWN0KHNvdXJjZSk7CiAgICB2YXIgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7CiAgICB2YXIgbWFwZm4gPSBhTGVuID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDsKICAgIHZhciBtYXBwaW5nID0gbWFwZm4gIT09IHVuZGVmaW5lZDsKICAgIHZhciBpdGVyRm4gPSBnZXRJdGVyRm4oTyk7CiAgICB2YXIgaSwgbGVuZ3RoLCB2YWx1ZXMsIHJlc3VsdCwgc3RlcCwgaXRlcmF0b3I7CgogICAgaWYgKGl0ZXJGbiAhPSB1bmRlZmluZWQgJiYgIWlzQXJyYXlJdGVyKGl0ZXJGbikpIHsKICAgICAgZm9yIChpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKE8pLCB2YWx1ZXMgPSBbXSwgaSA9IDA7ICEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZTsgaSsrKSB7CiAgICAgICAgdmFsdWVzLnB1c2goc3RlcC52YWx1ZSk7CiAgICAgIH0KCiAgICAgIE8gPSB2YWx1ZXM7CiAgICB9CgogICAgaWYgKG1hcHBpbmcgJiYgYUxlbiA+IDIpIG1hcGZuID0gY3R4KG1hcGZuLCBhcmd1bWVudHNbMl0sIDIpOwoKICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKSwgcmVzdWx0ID0gYWxsb2NhdGUodGhpcywgbGVuZ3RoKTsgbGVuZ3RoID4gaTsgaSsrKSB7CiAgICAgIHJlc3VsdFtpXSA9IG1hcHBpbmcgPyBtYXBmbihPW2ldLCBpKSA6IE9baV07CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9OwoKICB2YXIgJG9mID0gZnVuY3Rpb24gb2YoKQogIC8qIC4uLml0ZW1zICovCiAgewogICAgdmFyIGluZGV4ID0gMDsKICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoOwogICAgdmFyIHJlc3VsdCA9IGFsbG9jYXRlKHRoaXMsIGxlbmd0aCk7CgogICAgd2hpbGUgKGxlbmd0aCA+IGluZGV4KSB7CiAgICAgIHJlc3VsdFtpbmRleF0gPSBhcmd1bWVudHNbaW5kZXgrK107CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9OyAvLyBpT1MgU2FmYXJpIDYueCBmYWlscyBoZXJlCgoKICB2YXIgVE9fTE9DQUxFX0JVRyA9ICEhVWludDhBcnJheSAmJiBmYWlscyhmdW5jdGlvbiAoKSB7CiAgICBhcnJheVRvTG9jYWxlU3RyaW5nLmNhbGwobmV3IFVpbnQ4QXJyYXkoMSkpOwogIH0pOwoKICB2YXIgJHRvTG9jYWxlU3RyaW5nID0gZnVuY3Rpb24gdG9Mb2NhbGVTdHJpbmcoKSB7CiAgICByZXR1cm4gYXJyYXlUb0xvY2FsZVN0cmluZy5hcHBseShUT19MT0NBTEVfQlVHID8gYXJyYXlTbGljZS5jYWxsKHZhbGlkYXRlKHRoaXMpKSA6IHZhbGlkYXRlKHRoaXMpLCBhcmd1bWVudHMpOwogIH07CgogIHZhciBwcm90byA9IHsKICAgIGNvcHlXaXRoaW46IGZ1bmN0aW9uIGNvcHlXaXRoaW4odGFyZ2V0LCBzdGFydAogICAgLyogLCBlbmQgKi8KICAgICkgewogICAgICByZXR1cm4gYXJyYXlDb3B5V2l0aGluLmNhbGwodmFsaWRhdGUodGhpcyksIHRhcmdldCwgc3RhcnQsIGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkKTsKICAgIH0sCiAgICBldmVyeTogZnVuY3Rpb24gZXZlcnkoY2FsbGJhY2tmbgogICAgLyogLCB0aGlzQXJnICovCiAgICApIHsKICAgICAgcmV0dXJuIGFycmF5RXZlcnkodmFsaWRhdGUodGhpcyksIGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsKICAgIH0sCiAgICBmaWxsOiBmdW5jdGlvbiBmaWxsKHZhbHVlCiAgICAvKiAsIHN0YXJ0LCBlbmQgKi8KICAgICkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzCiAgICAgIHJldHVybiBhcnJheUZpbGwuYXBwbHkodmFsaWRhdGUodGhpcyksIGFyZ3VtZW50cyk7CiAgICB9LAogICAgZmlsdGVyOiBmdW5jdGlvbiBmaWx0ZXIoY2FsbGJhY2tmbgogICAgLyogLCB0aGlzQXJnICovCiAgICApIHsKICAgICAgcmV0dXJuIHNwZWNpZXNGcm9tTGlzdCh0aGlzLCBhcnJheUZpbHRlcih2YWxpZGF0ZSh0aGlzKSwgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpKTsKICAgIH0sCiAgICBmaW5kOiBmdW5jdGlvbiBmaW5kKHByZWRpY2F0ZQogICAgLyogLCB0aGlzQXJnICovCiAgICApIHsKICAgICAgcmV0dXJuIGFycmF5RmluZCh2YWxpZGF0ZSh0aGlzKSwgcHJlZGljYXRlLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7CiAgICB9LAogICAgZmluZEluZGV4OiBmdW5jdGlvbiBmaW5kSW5kZXgocHJlZGljYXRlCiAgICAvKiAsIHRoaXNBcmcgKi8KICAgICkgewogICAgICByZXR1cm4gYXJyYXlGaW5kSW5kZXgodmFsaWRhdGUodGhpcyksIHByZWRpY2F0ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpOwogICAgfSwKICAgIGZvckVhY2g6IGZ1bmN0aW9uIGZvckVhY2goY2FsbGJhY2tmbgogICAgLyogLCB0aGlzQXJnICovCiAgICApIHsKICAgICAgYXJyYXlGb3JFYWNoKHZhbGlkYXRlKHRoaXMpLCBjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7CiAgICB9LAogICAgaW5kZXhPZjogZnVuY3Rpb24gaW5kZXhPZihzZWFyY2hFbGVtZW50CiAgICAvKiAsIGZyb21JbmRleCAqLwogICAgKSB7CiAgICAgIHJldHVybiBhcnJheUluZGV4T2YodmFsaWRhdGUodGhpcyksIHNlYXJjaEVsZW1lbnQsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsKICAgIH0sCiAgICBpbmNsdWRlczogZnVuY3Rpb24gaW5jbHVkZXMoc2VhcmNoRWxlbWVudAogICAgLyogLCBmcm9tSW5kZXggKi8KICAgICkgewogICAgICByZXR1cm4gYXJyYXlJbmNsdWRlcyh2YWxpZGF0ZSh0aGlzKSwgc2VhcmNoRWxlbWVudCwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpOwogICAgfSwKICAgIGpvaW46IGZ1bmN0aW9uIGpvaW4oc2VwYXJhdG9yKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgcmV0dXJuIGFycmF5Sm9pbi5hcHBseSh2YWxpZGF0ZSh0aGlzKSwgYXJndW1lbnRzKTsKICAgIH0sCiAgICBsYXN0SW5kZXhPZjogZnVuY3Rpb24gbGFzdEluZGV4T2Yoc2VhcmNoRWxlbWVudAogICAgLyogLCBmcm9tSW5kZXggKi8KICAgICkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzCiAgICAgIHJldHVybiBhcnJheUxhc3RJbmRleE9mLmFwcGx5KHZhbGlkYXRlKHRoaXMpLCBhcmd1bWVudHMpOwogICAgfSwKICAgIG1hcDogZnVuY3Rpb24gbWFwKG1hcGZuCiAgICAvKiAsIHRoaXNBcmcgKi8KICAgICkgewogICAgICByZXR1cm4gJG1hcCh2YWxpZGF0ZSh0aGlzKSwgbWFwZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsKICAgIH0sCiAgICByZWR1Y2U6IGZ1bmN0aW9uIHJlZHVjZShjYWxsYmFja2ZuCiAgICAvKiAsIGluaXRpYWxWYWx1ZSAqLwogICAgKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgcmV0dXJuIGFycmF5UmVkdWNlLmFwcGx5KHZhbGlkYXRlKHRoaXMpLCBhcmd1bWVudHMpOwogICAgfSwKICAgIHJlZHVjZVJpZ2h0OiBmdW5jdGlvbiByZWR1Y2VSaWdodChjYWxsYmFja2ZuCiAgICAvKiAsIGluaXRpYWxWYWx1ZSAqLwogICAgKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgcmV0dXJuIGFycmF5UmVkdWNlUmlnaHQuYXBwbHkodmFsaWRhdGUodGhpcyksIGFyZ3VtZW50cyk7CiAgICB9LAogICAgcmV2ZXJzZTogZnVuY3Rpb24gcmV2ZXJzZSgpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB2YXIgbGVuZ3RoID0gdmFsaWRhdGUodGhhdCkubGVuZ3RoOwogICAgICB2YXIgbWlkZGxlID0gTWF0aC5mbG9vcihsZW5ndGggLyAyKTsKICAgICAgdmFyIGluZGV4ID0gMDsKICAgICAgdmFyIHZhbHVlOwoKICAgICAgd2hpbGUgKGluZGV4IDwgbWlkZGxlKSB7CiAgICAgICAgdmFsdWUgPSB0aGF0W2luZGV4XTsKICAgICAgICB0aGF0W2luZGV4KytdID0gdGhhdFstLWxlbmd0aF07CiAgICAgICAgdGhhdFtsZW5ndGhdID0gdmFsdWU7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGF0OwogICAgfSwKICAgIHNvbWU6IGZ1bmN0aW9uIHNvbWUoY2FsbGJhY2tmbgogICAgLyogLCB0aGlzQXJnICovCiAgICApIHsKICAgICAgcmV0dXJuIGFycmF5U29tZSh2YWxpZGF0ZSh0aGlzKSwgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpOwogICAgfSwKICAgIHNvcnQ6IGZ1bmN0aW9uIHNvcnQoY29tcGFyZWZuKSB7CiAgICAgIHJldHVybiBhcnJheVNvcnQuY2FsbCh2YWxpZGF0ZSh0aGlzKSwgY29tcGFyZWZuKTsKICAgIH0sCiAgICBzdWJhcnJheTogZnVuY3Rpb24gc3ViYXJyYXkoYmVnaW4sIGVuZCkgewogICAgICB2YXIgTyA9IHZhbGlkYXRlKHRoaXMpOwogICAgICB2YXIgbGVuZ3RoID0gTy5sZW5ndGg7CiAgICAgIHZhciAkYmVnaW4gPSB0b0Fic29sdXRlSW5kZXgoYmVnaW4sIGxlbmd0aCk7CiAgICAgIHJldHVybiBuZXcgKHNwZWNpZXNDb25zdHJ1Y3RvcihPLCBPW0RFRl9DT05TVFJVQ1RPUl0pKShPLmJ1ZmZlciwgTy5ieXRlT2Zmc2V0ICsgJGJlZ2luICogTy5CWVRFU19QRVJfRUxFTUVOVCwgdG9MZW5ndGgoKGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuZ3RoIDogdG9BYnNvbHV0ZUluZGV4KGVuZCwgbGVuZ3RoKSkgLSAkYmVnaW4pKTsKICAgIH0KICB9OwoKICB2YXIgJHNsaWNlID0gZnVuY3Rpb24gc2xpY2Uoc3RhcnQsIGVuZCkgewogICAgcmV0dXJuIHNwZWNpZXNGcm9tTGlzdCh0aGlzLCBhcnJheVNsaWNlLmNhbGwodmFsaWRhdGUodGhpcyksIHN0YXJ0LCBlbmQpKTsKICB9OwoKICB2YXIgJHNldCA9IGZ1bmN0aW9uIHNldChhcnJheUxpa2UKICAvKiAsIG9mZnNldCAqLwogICkgewogICAgdmFsaWRhdGUodGhpcyk7CiAgICB2YXIgb2Zmc2V0ID0gdG9PZmZzZXQoYXJndW1lbnRzWzFdLCAxKTsKICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aDsKICAgIHZhciBzcmMgPSB0b09iamVjdChhcnJheUxpa2UpOwogICAgdmFyIGxlbiA9IHRvTGVuZ3RoKHNyYy5sZW5ndGgpOwogICAgdmFyIGluZGV4ID0gMDsKICAgIGlmIChsZW4gKyBvZmZzZXQgPiBsZW5ndGgpIHRocm93IFJhbmdlRXJyb3IoV1JPTkdfTEVOR1RIKTsKCiAgICB3aGlsZSAoaW5kZXggPCBsZW4pIHsKICAgICAgdGhpc1tvZmZzZXQgKyBpbmRleF0gPSBzcmNbaW5kZXgrK107CiAgICB9CiAgfTsKCiAgdmFyICRpdGVyYXRvcnMgPSB7CiAgICBlbnRyaWVzOiBmdW5jdGlvbiBlbnRyaWVzKCkgewogICAgICByZXR1cm4gYXJyYXlFbnRyaWVzLmNhbGwodmFsaWRhdGUodGhpcykpOwogICAgfSwKICAgIGtleXM6IGZ1bmN0aW9uIGtleXMoKSB7CiAgICAgIHJldHVybiBhcnJheUtleXMuY2FsbCh2YWxpZGF0ZSh0aGlzKSk7CiAgICB9LAogICAgdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoKSB7CiAgICAgIHJldHVybiBhcnJheVZhbHVlcy5jYWxsKHZhbGlkYXRlKHRoaXMpKTsKICAgIH0KICB9OwoKICB2YXIgaXNUQUluZGV4ID0gZnVuY3Rpb24gaXNUQUluZGV4KHRhcmdldCwga2V5KSB7CiAgICByZXR1cm4gaXNPYmplY3QodGFyZ2V0KSAmJiB0YXJnZXRbVFlQRURfQVJSQVldICYmIF90eXBlb2Yoa2V5KSAhPSAnc3ltYm9sJyAmJiBrZXkgaW4gdGFyZ2V0ICYmIFN0cmluZygra2V5KSA9PSBTdHJpbmcoa2V5KTsKICB9OwoKICB2YXIgJGdldERlc2MgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIHsKICAgIHJldHVybiBpc1RBSW5kZXgodGFyZ2V0LCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKSA/IHByb3BlcnR5RGVzYygyLCB0YXJnZXRba2V5XSkgOiBnT1BEKHRhcmdldCwga2V5KTsKICB9OwoKICB2YXIgJHNldERlc2MgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgZGVzYykgewogICAgaWYgKGlzVEFJbmRleCh0YXJnZXQsIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSkpICYmIGlzT2JqZWN0KGRlc2MpICYmIGhhcyhkZXNjLCAndmFsdWUnKSAmJiAhaGFzKGRlc2MsICdnZXQnKSAmJiAhaGFzKGRlc2MsICdzZXQnKSAvLyBUT0RPOiBhZGQgdmFsaWRhdGlvbiBkZXNjcmlwdG9yIHcvbyBjYWxsaW5nIGFjY2Vzc29ycwogICAgJiYgIWRlc2MuY29uZmlndXJhYmxlICYmICghaGFzKGRlc2MsICd3cml0YWJsZScpIHx8IGRlc2Mud3JpdGFibGUpICYmICghaGFzKGRlc2MsICdlbnVtZXJhYmxlJykgfHwgZGVzYy5lbnVtZXJhYmxlKSkgewogICAgICB0YXJnZXRba2V5XSA9IGRlc2MudmFsdWU7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogICAgcmV0dXJuIGRQKHRhcmdldCwga2V5LCBkZXNjKTsKICB9OwoKICBpZiAoIUFMTF9DT05TVFJVQ1RPUlMpIHsKICAgICRHT1BELmYgPSAkZ2V0RGVzYzsKICAgICREUC5mID0gJHNldERlc2M7CiAgfQoKICAkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFBTExfQ09OU1RSVUNUT1JTLCAnT2JqZWN0JywgewogICAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiAkZ2V0RGVzYywKICAgIGRlZmluZVByb3BlcnR5OiAkc2V0RGVzYwogIH0pOwoKICBpZiAoZmFpbHMoZnVuY3Rpb24gKCkgewogICAgYXJyYXlUb1N0cmluZy5jYWxsKHt9KTsKICB9KSkgewogICAgYXJyYXlUb1N0cmluZyA9IGFycmF5VG9Mb2NhbGVTdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHsKICAgICAgcmV0dXJuIGFycmF5Sm9pbi5jYWxsKHRoaXMpOwogICAgfTsKICB9CgogIHZhciAkVHlwZWRBcnJheVByb3RvdHlwZSQgPSByZWRlZmluZUFsbCh7fSwgcHJvdG8pOwogIHJlZGVmaW5lQWxsKCRUeXBlZEFycmF5UHJvdG90eXBlJCwgJGl0ZXJhdG9ycyk7CiAgaGlkZSgkVHlwZWRBcnJheVByb3RvdHlwZSQsIElURVJBVE9SLCAkaXRlcmF0b3JzLnZhbHVlcyk7CiAgcmVkZWZpbmVBbGwoJFR5cGVkQXJyYXlQcm90b3R5cGUkLCB7CiAgICBzbGljZTogJHNsaWNlLAogICAgc2V0OiAkc2V0LAogICAgY29uc3RydWN0b3I6IGZ1bmN0aW9uIGNvbnN0cnVjdG9yKCkgewogICAgICAvKiBub29wICovCiAgICB9LAogICAgdG9TdHJpbmc6IGFycmF5VG9TdHJpbmcsCiAgICB0b0xvY2FsZVN0cmluZzogJHRvTG9jYWxlU3RyaW5nCiAgfSk7CiAgYWRkR2V0dGVyKCRUeXBlZEFycmF5UHJvdG90eXBlJCwgJ2J1ZmZlcicsICdiJyk7CiAgYWRkR2V0dGVyKCRUeXBlZEFycmF5UHJvdG90eXBlJCwgJ2J5dGVPZmZzZXQnLCAnbycpOwogIGFkZEdldHRlcigkVHlwZWRBcnJheVByb3RvdHlwZSQsICdieXRlTGVuZ3RoJywgJ2wnKTsKICBhZGRHZXR0ZXIoJFR5cGVkQXJyYXlQcm90b3R5cGUkLCAnbGVuZ3RoJywgJ2UnKTsKICBkUCgkVHlwZWRBcnJheVByb3RvdHlwZSQsIFRBRywgewogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzW1RZUEVEX0FSUkFZXTsKICAgIH0KICB9KTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1zdGF0ZW1lbnRzCgogIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEtFWSwgQllURVMsIHdyYXBwZXIsIENMQU1QRUQpIHsKICAgIENMQU1QRUQgPSAhIUNMQU1QRUQ7CiAgICB2YXIgTkFNRSA9IEtFWSArIChDTEFNUEVEID8gJ0NsYW1wZWQnIDogJycpICsgJ0FycmF5JzsKICAgIHZhciBHRVRURVIgPSAnZ2V0JyArIEtFWTsKICAgIHZhciBTRVRURVIgPSAnc2V0JyArIEtFWTsKICAgIHZhciBUeXBlZEFycmF5ID0gZ2xvYmFsW05BTUVdOwogICAgdmFyIEJhc2UgPSBUeXBlZEFycmF5IHx8IHt9OwogICAgdmFyIFRBQyA9IFR5cGVkQXJyYXkgJiYgZ2V0UHJvdG90eXBlT2YoVHlwZWRBcnJheSk7CiAgICB2YXIgRk9SQ0VEID0gIVR5cGVkQXJyYXkgfHwgISR0eXBlZC5BQlY7CiAgICB2YXIgTyA9IHt9OwogICAgdmFyIFR5cGVkQXJyYXlQcm90b3R5cGUgPSBUeXBlZEFycmF5ICYmIFR5cGVkQXJyYXlbUFJPVE9UWVBFXTsKCiAgICB2YXIgZ2V0dGVyID0gZnVuY3Rpb24gZ2V0dGVyKHRoYXQsIGluZGV4KSB7CiAgICAgIHZhciBkYXRhID0gdGhhdC5fZDsKICAgICAgcmV0dXJuIGRhdGEudltHRVRURVJdKGluZGV4ICogQllURVMgKyBkYXRhLm8sIExJVFRMRV9FTkRJQU4pOwogICAgfTsKCiAgICB2YXIgc2V0dGVyID0gZnVuY3Rpb24gc2V0dGVyKHRoYXQsIGluZGV4LCB2YWx1ZSkgewogICAgICB2YXIgZGF0YSA9IHRoYXQuX2Q7CiAgICAgIGlmIChDTEFNUEVEKSB2YWx1ZSA9ICh2YWx1ZSA9IE1hdGgucm91bmQodmFsdWUpKSA8IDAgPyAwIDogdmFsdWUgPiAweGZmID8gMHhmZiA6IHZhbHVlICYgMHhmZjsKICAgICAgZGF0YS52W1NFVFRFUl0oaW5kZXggKiBCWVRFUyArIGRhdGEubywgdmFsdWUsIExJVFRMRV9FTkRJQU4pOwogICAgfTsKCiAgICB2YXIgYWRkRWxlbWVudCA9IGZ1bmN0aW9uIGFkZEVsZW1lbnQodGhhdCwgaW5kZXgpIHsKICAgICAgZFAodGhhdCwgaW5kZXgsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgIHJldHVybiBnZXR0ZXIodGhpcywgaW5kZXgpOwogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHsKICAgICAgICAgIHJldHVybiBzZXR0ZXIodGhpcywgaW5kZXgsIHZhbHVlKTsKICAgICAgICB9LAogICAgICAgIGVudW1lcmFibGU6IHRydWUKICAgICAgfSk7CiAgICB9OwoKICAgIGlmIChGT1JDRUQpIHsKICAgICAgVHlwZWRBcnJheSA9IHdyYXBwZXIoZnVuY3Rpb24gKHRoYXQsIGRhdGEsICRvZmZzZXQsICRsZW5ndGgpIHsKICAgICAgICBhbkluc3RhbmNlKHRoYXQsIFR5cGVkQXJyYXksIE5BTUUsICdfZCcpOwogICAgICAgIHZhciBpbmRleCA9IDA7CiAgICAgICAgdmFyIG9mZnNldCA9IDA7CiAgICAgICAgdmFyIGJ1ZmZlciwgYnl0ZUxlbmd0aCwgbGVuZ3RoLCBrbGFzczsKCiAgICAgICAgaWYgKCFpc09iamVjdChkYXRhKSkgewogICAgICAgICAgbGVuZ3RoID0gdG9JbmRleChkYXRhKTsKICAgICAgICAgIGJ5dGVMZW5ndGggPSBsZW5ndGggKiBCWVRFUzsKICAgICAgICAgIGJ1ZmZlciA9IG5ldyAkQXJyYXlCdWZmZXIoYnl0ZUxlbmd0aCk7CiAgICAgICAgfSBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgJEFycmF5QnVmZmVyIHx8IChrbGFzcyA9IGNsYXNzb2YoZGF0YSkpID09IEFSUkFZX0JVRkZFUiB8fCBrbGFzcyA9PSBTSEFSRURfQlVGRkVSKSB7CiAgICAgICAgICBidWZmZXIgPSBkYXRhOwogICAgICAgICAgb2Zmc2V0ID0gdG9PZmZzZXQoJG9mZnNldCwgQllURVMpOwogICAgICAgICAgdmFyICRsZW4gPSBkYXRhLmJ5dGVMZW5ndGg7CgogICAgICAgICAgaWYgKCRsZW5ndGggPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBpZiAoJGxlbiAlIEJZVEVTKSB0aHJvdyBSYW5nZUVycm9yKFdST05HX0xFTkdUSCk7CiAgICAgICAgICAgIGJ5dGVMZW5ndGggPSAkbGVuIC0gb2Zmc2V0OwogICAgICAgICAgICBpZiAoYnl0ZUxlbmd0aCA8IDApIHRocm93IFJhbmdlRXJyb3IoV1JPTkdfTEVOR1RIKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGJ5dGVMZW5ndGggPSB0b0xlbmd0aCgkbGVuZ3RoKSAqIEJZVEVTOwogICAgICAgICAgICBpZiAoYnl0ZUxlbmd0aCArIG9mZnNldCA+ICRsZW4pIHRocm93IFJhbmdlRXJyb3IoV1JPTkdfTEVOR1RIKTsKICAgICAgICAgIH0KCiAgICAgICAgICBsZW5ndGggPSBieXRlTGVuZ3RoIC8gQllURVM7CiAgICAgICAgfSBlbHNlIGlmIChUWVBFRF9BUlJBWSBpbiBkYXRhKSB7CiAgICAgICAgICByZXR1cm4gZnJvbUxpc3QoVHlwZWRBcnJheSwgZGF0YSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiAkZnJvbS5jYWxsKFR5cGVkQXJyYXksIGRhdGEpOwogICAgICAgIH0KCiAgICAgICAgaGlkZSh0aGF0LCAnX2QnLCB7CiAgICAgICAgICBiOiBidWZmZXIsCiAgICAgICAgICBvOiBvZmZzZXQsCiAgICAgICAgICBsOiBieXRlTGVuZ3RoLAogICAgICAgICAgZTogbGVuZ3RoLAogICAgICAgICAgdjogbmV3ICREYXRhVmlldyhidWZmZXIpCiAgICAgICAgfSk7CgogICAgICAgIHdoaWxlIChpbmRleCA8IGxlbmd0aCkgewogICAgICAgICAgYWRkRWxlbWVudCh0aGF0LCBpbmRleCsrKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBUeXBlZEFycmF5UHJvdG90eXBlID0gVHlwZWRBcnJheVtQUk9UT1RZUEVdID0gY3JlYXRlKCRUeXBlZEFycmF5UHJvdG90eXBlJCk7CiAgICAgIGhpZGUoVHlwZWRBcnJheVByb3RvdHlwZSwgJ2NvbnN0cnVjdG9yJywgVHlwZWRBcnJheSk7CiAgICB9IGVsc2UgaWYgKCFmYWlscyhmdW5jdGlvbiAoKSB7CiAgICAgIFR5cGVkQXJyYXkoMSk7CiAgICB9KSB8fCAhZmFpbHMoZnVuY3Rpb24gKCkgewogICAgICBuZXcgVHlwZWRBcnJheSgtMSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3CiAgICB9KSB8fCAhJGl0ZXJEZXRlY3QoZnVuY3Rpb24gKGl0ZXIpIHsKICAgICAgbmV3IFR5cGVkQXJyYXkoKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXcKCiAgICAgIG5ldyBUeXBlZEFycmF5KG51bGwpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldwoKICAgICAgbmV3IFR5cGVkQXJyYXkoMS41KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXcKCiAgICAgIG5ldyBUeXBlZEFycmF5KGl0ZXIpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldwogICAgfSwgdHJ1ZSkpIHsKICAgICAgVHlwZWRBcnJheSA9IHdyYXBwZXIoZnVuY3Rpb24gKHRoYXQsIGRhdGEsICRvZmZzZXQsICRsZW5ndGgpIHsKICAgICAgICBhbkluc3RhbmNlKHRoYXQsIFR5cGVkQXJyYXksIE5BTUUpOwogICAgICAgIHZhciBrbGFzczsgLy8gYHdzYCBtb2R1bGUgYnVnLCB0ZW1wb3JhcmlseSByZW1vdmUgdmFsaWRhdGlvbiBsZW5ndGggZm9yIFVpbnQ4QXJyYXkKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vd2Vic29ja2V0cy93cy9wdWxsLzY0NQoKICAgICAgICBpZiAoIWlzT2JqZWN0KGRhdGEpKSByZXR1cm4gbmV3IEJhc2UodG9JbmRleChkYXRhKSk7CgogICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgJEFycmF5QnVmZmVyIHx8IChrbGFzcyA9IGNsYXNzb2YoZGF0YSkpID09IEFSUkFZX0JVRkZFUiB8fCBrbGFzcyA9PSBTSEFSRURfQlVGRkVSKSB7CiAgICAgICAgICByZXR1cm4gJGxlbmd0aCAhPT0gdW5kZWZpbmVkID8gbmV3IEJhc2UoZGF0YSwgdG9PZmZzZXQoJG9mZnNldCwgQllURVMpLCAkbGVuZ3RoKSA6ICRvZmZzZXQgIT09IHVuZGVmaW5lZCA/IG5ldyBCYXNlKGRhdGEsIHRvT2Zmc2V0KCRvZmZzZXQsIEJZVEVTKSkgOiBuZXcgQmFzZShkYXRhKTsKICAgICAgICB9CgogICAgICAgIGlmIChUWVBFRF9BUlJBWSBpbiBkYXRhKSByZXR1cm4gZnJvbUxpc3QoVHlwZWRBcnJheSwgZGF0YSk7CiAgICAgICAgcmV0dXJuICRmcm9tLmNhbGwoVHlwZWRBcnJheSwgZGF0YSk7CiAgICAgIH0pOwogICAgICBhcnJheUZvckVhY2goVEFDICE9PSBGdW5jdGlvbi5wcm90b3R5cGUgPyBnT1BOKEJhc2UpLmNvbmNhdChnT1BOKFRBQykpIDogZ09QTihCYXNlKSwgZnVuY3Rpb24gKGtleSkgewogICAgICAgIGlmICghKGtleSBpbiBUeXBlZEFycmF5KSkgaGlkZShUeXBlZEFycmF5LCBrZXksIEJhc2Vba2V5XSk7CiAgICAgIH0pOwogICAgICBUeXBlZEFycmF5W1BST1RPVFlQRV0gPSBUeXBlZEFycmF5UHJvdG90eXBlOwogICAgICBpZiAoIUxJQlJBUlkpIFR5cGVkQXJyYXlQcm90b3R5cGUuY29uc3RydWN0b3IgPSBUeXBlZEFycmF5OwogICAgfQoKICAgIHZhciAkbmF0aXZlSXRlcmF0b3IgPSBUeXBlZEFycmF5UHJvdG90eXBlW0lURVJBVE9SXTsKICAgIHZhciBDT1JSRUNUX0lURVJfTkFNRSA9ICEhJG5hdGl2ZUl0ZXJhdG9yICYmICgkbmF0aXZlSXRlcmF0b3IubmFtZSA9PSAndmFsdWVzJyB8fCAkbmF0aXZlSXRlcmF0b3IubmFtZSA9PSB1bmRlZmluZWQpOwogICAgdmFyICRpdGVyYXRvciA9ICRpdGVyYXRvcnMudmFsdWVzOwogICAgaGlkZShUeXBlZEFycmF5LCBUWVBFRF9DT05TVFJVQ1RPUiwgdHJ1ZSk7CiAgICBoaWRlKFR5cGVkQXJyYXlQcm90b3R5cGUsIFRZUEVEX0FSUkFZLCBOQU1FKTsKICAgIGhpZGUoVHlwZWRBcnJheVByb3RvdHlwZSwgVklFVywgdHJ1ZSk7CiAgICBoaWRlKFR5cGVkQXJyYXlQcm90b3R5cGUsIERFRl9DT05TVFJVQ1RPUiwgVHlwZWRBcnJheSk7CgogICAgaWYgKENMQU1QRUQgPyBuZXcgVHlwZWRBcnJheSgxKVtUQUddICE9IE5BTUUgOiAhKFRBRyBpbiBUeXBlZEFycmF5UHJvdG90eXBlKSkgewogICAgICBkUChUeXBlZEFycmF5UHJvdG90eXBlLCBUQUcsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgIHJldHVybiBOQU1FOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgT1tOQU1FXSA9IFR5cGVkQXJyYXk7CiAgICAkZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiAqIChUeXBlZEFycmF5ICE9IEJhc2UpLCBPKTsKICAgICRleHBvcnQoJGV4cG9ydC5TLCBOQU1FLCB7CiAgICAgIEJZVEVTX1BFUl9FTEVNRU5UOiBCWVRFUwogICAgfSk7CiAgICAkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIGZhaWxzKGZ1bmN0aW9uICgpIHsKICAgICAgQmFzZS5vZi5jYWxsKFR5cGVkQXJyYXksIDEpOwogICAgfSksIE5BTUUsIHsKICAgICAgZnJvbTogJGZyb20sCiAgICAgIG9mOiAkb2YKICAgIH0pOwogICAgaWYgKCEoQllURVNfUEVSX0VMRU1FTlQgaW4gVHlwZWRBcnJheVByb3RvdHlwZSkpIGhpZGUoVHlwZWRBcnJheVByb3RvdHlwZSwgQllURVNfUEVSX0VMRU1FTlQsIEJZVEVTKTsKICAgICRleHBvcnQoJGV4cG9ydC5QLCBOQU1FLCBwcm90byk7CiAgICBzZXRTcGVjaWVzKE5BTUUpOwogICAgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiBGT1JDRURfU0VULCBOQU1FLCB7CiAgICAgIHNldDogJHNldAogICAgfSk7CiAgICAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqICFDT1JSRUNUX0lURVJfTkFNRSwgTkFNRSwgJGl0ZXJhdG9ycyk7CiAgICBpZiAoIUxJQlJBUlkgJiYgVHlwZWRBcnJheVByb3RvdHlwZS50b1N0cmluZyAhPSBhcnJheVRvU3RyaW5nKSBUeXBlZEFycmF5UHJvdG90eXBlLnRvU3RyaW5nID0gYXJyYXlUb1N0cmluZzsKICAgICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogZmFpbHMoZnVuY3Rpb24gKCkgewogICAgICBuZXcgVHlwZWRBcnJheSgxKS5zbGljZSgpOwogICAgfSksIE5BTUUsIHsKICAgICAgc2xpY2U6ICRzbGljZQogICAgfSk7CiAgICAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChmYWlscyhmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBbMSwgMl0udG9Mb2NhbGVTdHJpbmcoKSAhPSBuZXcgVHlwZWRBcnJheShbMSwgMl0pLnRvTG9jYWxlU3RyaW5nKCk7CiAgICB9KSB8fCAhZmFpbHMoZnVuY3Rpb24gKCkgewogICAgICBUeXBlZEFycmF5UHJvdG90eXBlLnRvTG9jYWxlU3RyaW5nLmNhbGwoWzEsIDJdKTsKICAgIH0pKSwgTkFNRSwgewogICAgICB0b0xvY2FsZVN0cmluZzogJHRvTG9jYWxlU3RyaW5nCiAgICB9KTsKICAgIEl0ZXJhdG9yc1tOQU1FXSA9IENPUlJFQ1RfSVRFUl9OQU1FID8gJG5hdGl2ZUl0ZXJhdG9yIDogJGl0ZXJhdG9yOwogICAgaWYgKCFMSUJSQVJZICYmICFDT1JSRUNUX0lURVJfTkFNRSkgaGlkZShUeXBlZEFycmF5UHJvdG90eXBlLCBJVEVSQVRPUiwgJGl0ZXJhdG9yKTsKICB9Owp9IGVsc2UgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7CiAgLyogZW1wdHkgKi8KfTsKCmlmIChtb2R1bGUuaG90KSB7CiAgbW9kdWxlLmhvdC5hY2NlcHQoKTsKfQ=="},null]}